(function(){define(["angular"],function(a){var b;b=a.module("comet",[]),b.factory("$comet",["$rootScope","$location",function(b){return function(c,d,e){var f,g,h,i;return f=_.uniqueId("cb_fn_krl_"),h=_.uniqueId("krl-"),window.cb||(window.cb={}),window.cb[f]=function(a){a=JSON.parse(a),b.$apply(function(){return d(a.type,a.message)})},e?(i=a.element("<iframe/>",{id:h,name:h}).hide(),g=a.element("<form/>",{id:"form-"+h,method:"POST",target:h,action:c.replace(":cbFn",f)}),g.append(a.element("<input/>",{type:"hidden",name:"data",value:JSON.stringify(e)})),a.element("body").append(i),a.element("body").append(g),g.submit()):(i=a.element("<iframe/>",{id:h,src:c.replace(":cbFn",f)}).hide(),a.element("body").append(i)),{dispose:function(){i.remove()}}}}])})}).call(this);